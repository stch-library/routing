<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>stch.routing documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Routing 0.1.0 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><span>Namespaces</span></h3><ul><li><a href="stch.fingertree.html"><span>stch.fingertree</span></a></li><li><a href="stch.response.html"><span>stch.response</span></a></li><li class="current"><a href="stch.routing.html"><span>stch.routing</span></a></li><li><a href="stch.routing.parse.html"><span>stch.routing.parse</span></a></li><li><a href="stch.zipper.html"><span>stch.zipper</span></a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="stch.routing.html#var-*router*"><span>*router*</span></a></li><li><a href="stch.routing.html#var--%3ERouter"><span>-&gt;Router</span></a></li><li><a href="stch.routing.html#var--body"><span>-body</span></a></li><li><a href="stch.routing.html#var--domain"><span>-domain</span></a></li><li><a href="stch.routing.html#var--guard"><span>-guard</span></a></li><li><a href="stch.routing.html#var--headers"><span>-headers</span></a></li><li><a href="stch.routing.html#var--index"><span>-index</span></a></li><li><a href="stch.routing.html#var--lookup-header"><span>-lookup-header</span></a></li><li><a href="stch.routing.html#var--lookup-param"><span>-lookup-param</span></a></li><li><a href="stch.routing.html#var--method"><span>-method</span></a></li><li><a href="stch.routing.html#var--not-traversed"><span>-not-traversed</span></a></li><li><a href="stch.routing.html#var--param"><span>-param</span></a></li><li><a href="stch.routing.html#var--params"><span>-params</span></a></li><li><a href="stch.routing.html#var--path"><span>-path</span></a></li><li><a href="stch.routing.html#var--pred"><span>-pred</span></a></li><li><a href="stch.routing.html#var--request"><span>-request</span></a></li><li><a href="stch.routing.html#var--scheme"><span>-scheme</span></a></li><li><a href="stch.routing.html#var--static"><span>-static</span></a></li><li><a href="stch.routing.html#var--terminate"><span>-terminate</span></a></li><li><a href="stch.routing.html#var--truncate"><span>-truncate</span></a></li><li><a href="stch.routing.html#var--url"><span>-url</span></a></li><li><a href="stch.routing.html#var--zipper"><span>-zipper</span></a></li><li><a href="stch.routing.html#var-IDispatch"><span>IDispatch</span></a></li><li><a href="stch.routing.html#var-IRequest"><span>IRequest</span></a></li><li><a href="stch.routing.html#var-Request"><span>Request</span></a></li><li><a href="stch.routing.html#var-RequestMethods"><span>RequestMethods</span></a></li><li><a href="stch.routing.html#var-body"><span>body</span></a></li><li><a href="stch.routing.html#var-defroute"><span>defroute</span></a></li><li><a href="stch.routing.html#var-defroute%27"><span>defroute'</span></a></li><li><a href="stch.routing.html#var-domain"><span>domain</span></a></li><li><a href="stch.routing.html#var-guard"><span>guard</span></a></li><li><a href="stch.routing.html#var-headers"><span>headers</span></a></li><li><a href="stch.routing.html#var-index"><span>index</span></a></li><li><a href="stch.routing.html#var-init-router"><span>init-router</span></a></li><li><a href="stch.routing.html#var-lookup-header"><span>lookup-header</span></a></li><li><a href="stch.routing.html#var-lookup-param"><span>lookup-param</span></a></li><li><a href="stch.routing.html#var-map-%3ERouter"><span>map-&gt;Router</span></a></li><li><a href="stch.routing.html#var-method"><span>method</span></a></li><li><a href="stch.routing.html#var-not-traversed"><span>not-traversed</span></a></li><li><a href="stch.routing.html#var-param"><span>param</span></a></li><li><a href="stch.routing.html#var-params"><span>params</span></a></li><li><a href="stch.routing.html#var-path"><span>path</span></a></li><li><a href="stch.routing.html#var-pred"><span>pred</span></a></li><li><a href="stch.routing.html#var-request"><span>request</span></a></li><li><a href="stch.routing.html#var-route"><span>route</span></a></li><li><a href="stch.routing.html#var-route%27"><span>route'</span></a></li><li><a href="stch.routing.html#var-routes"><span>routes</span></a></li><li><a href="stch.routing.html#var-scheme"><span>scheme</span></a></li><li><a href="stch.routing.html#var-static"><span>static</span></a></li><li><a href="stch.routing.html#var-strict-map-%3ERouter"><span>strict-map-&gt;Router</span></a></li><li><a href="stch.routing.html#var-terminate"><span>terminate</span></a></li><li><a href="stch.routing.html#var-truncate"><span>truncate</span></a></li><li><a href="stch.routing.html#var-url"><span>url</span></a></li><li><a href="stch.routing.html#var-zipper"><span>zipper</span></a></li></ul></div><div class="namespace-docs" id="content"><h2>stch.routing documentation</h2><pre class="doc">DSL for routing Ring requests.
</pre><div class="public" id="var-*router*"><h3>*router*</h3><div class="usage"></div><pre class="doc"></pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L22">Source</a></div></div><div class="public" id="var--%3ERouter"><h3>-&gt;Router</h3><div class="usage"><code>(-&gt;Router req req-path req-method resp)</code></div><pre class="doc">Positional factory function for class stch.routing.Router.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L240">Source</a></div></div><div class="public" id="var--body"><h3>-body</h3><div class="usage"><code>(-body this)</code></div><pre class="doc">Returns the request body.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--domain"><h3>-domain</h3><div class="usage"><code>(-domain this d f)</code></div><pre class="doc">If the server-name key matches d, call f.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--guard"><h3>-guard</h3><div class="usage"><code>(-guard this check)</code><code>(-guard this check msg)</code></div><pre class="doc">If check is falsey return immediately with a
forbidden error, and optional message.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--headers"><h3>-headers</h3><div class="usage"><code>(-headers this)</code></div><pre class="doc">Returns a map of the request headers.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--index"><h3>-index</h3><div class="usage"><code>(-index this f)</code></div><pre class="doc">If there are no path segments, call f.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--lookup-header"><h3>-lookup-header</h3><div class="usage"><code>(-lookup-header this header)</code></div><pre class="doc">Returns the specified header.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--lookup-param"><h3>-lookup-param</h3><div class="usage"><code>(-lookup-param this param)</code></div><pre class="doc">Returns the specified param.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--method"><h3>-method</h3><div class="usage"><code>(-method this meth f)</code></div><pre class="doc">If the request-method key matches meth,
call f.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--not-traversed"><h3>-not-traversed</h3><div class="usage"><code>(-not-traversed this f)</code></div><pre class="doc">If the current path level has not been traversed
previously, call f.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--param"><h3>-param</h3><div class="usage"><code>(-param this parser f)</code></div><pre class="doc">If the next path segment can be matched according
to regex pattern, use the corresponding parser and
pass the result to f.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--params"><h3>-params</h3><div class="usage"><code>(-params this)</code></div><pre class="doc">Returns the params map (if present).
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--path"><h3>-path</h3><div class="usage"><code>(-path this segment f)</code></div><pre class="doc">If the next path segment matches segment,
call f.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--pred"><h3>-pred</h3><div class="usage"><code>(-pred this p f)</code></div><pre class="doc">If (p path-segment) returns truthy then,
call f passing the result of the above.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--request"><h3>-request</h3><div class="usage"><code>(-request this)</code></div><pre class="doc">Returns the request map.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--scheme"><h3>-scheme</h3><div class="usage"><code>(-scheme this s f)</code></div><pre class="doc">If the scheme key matches s, call f.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--static"><h3>-static</h3><div class="usage"><code>(-static this segments opts)</code></div><pre class="doc">If the next path segment matches a value in the
segments set and the request method is get,
return a file response corresponding to the
requested file.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--terminate"><h3>-terminate</h3><div class="usage"><code>(-terminate this resp)</code></div><pre class="doc">Terminate and respond with resp immediately.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--truncate"><h3>-truncate</h3><div class="usage"><code>(-truncate this f)</code></div><pre class="doc">Truncate any remaining path segments and call f.
If a response is not created inside truncate
(for example, by means of a call to method),
revert the zipper to it's previous state.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--url"><h3>-url</h3><div class="usage"><code>(-url this)</code></div><pre class="doc">Returns the request url.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var--zipper"><h3>-zipper</h3><div class="usage"><code>(-zipper this)</code></div><pre class="doc">Inspect the current state of the zipper. Useful
for debugging.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/#L">Source</a></div></div><div class="public" id="var-IDispatch"><h3>IDispatch</h3><div class="usage"></div><pre class="doc">Dispatch a request.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L24">Source</a></div></div><div class="public" id="var-IRequest"><h3>IRequest</h3><div class="usage"></div><pre class="doc"></pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L175">Source</a></div></div><div class="public" id="var-Request"><h3>Request</h3><div class="usage"></div><pre class="doc">Request type annotation.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L13">Source</a></div></div><div class="public" id="var-RequestMethods"><h3>RequestMethods</h3><div class="usage"></div><pre class="doc">Request methods type annotation.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L9">Source</a></div></div><div class="public" id="var-body"><h3>body</h3><h4 class="macro">macro</h4><div class="usage"><code>(body)</code></div><pre class="doc">Returns the request body (if present).

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L233">Source</a></div></div><div class="public" id="var-defroute"><h3>defroute</h3><h4 class="macro">macro</h4><div class="usage"><code>(defroute name &amp; body)</code></div><pre class="doc">Define a route.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L371">Source</a></div></div><div class="public" id="var-defroute%27"><h3>defroute'</h3><h4 class="macro">macro</h4><div class="usage"><code>(defroute' name &amp; body)</code></div><pre class="doc">Define a route. Uses route'.
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L385">Source</a></div></div><div class="public" id="var-domain"><h3>domain</h3><h4 class="macro">macro</h4><div class="usage"><code>(domain d &amp; body)</code></div><pre class="doc">If the server-name key matches d, evaluate body.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L74">Source</a></div></div><div class="public" id="var-guard"><h3>guard</h3><h4 class="macro">macro</h4><div class="usage"><code>(guard check)</code><code>(guard check msg)</code></div><pre class="doc">If check is falsey return immediately with a
forbidden error, and optional message.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L157">Source</a></div></div><div class="public" id="var-headers"><h3>headers</h3><h4 class="macro">macro</h4><div class="usage"><code>(headers)</code></div><pre class="doc">Returns a map of the request headers.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L219">Source</a></div></div><div class="public" id="var-index"><h3>index</h3><h4 class="macro">macro</h4><div class="usage"><code>(index &amp; body)</code></div><pre class="doc">If there are no path segments, evaluate body.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L90">Source</a></div></div><div class="public" id="var-init-router"><h3>init-router</h3><div class="usage"><code>(init-router req)</code></div><pre class="doc">Inputs: [req :- Request]
Returns: Router

Initialize the router.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L355">Source</a></div></div><div class="public" id="var-lookup-header"><h3>lookup-header</h3><h4 class="macro">macro</h4><div class="usage"><code>(lookup-header header)</code></div><pre class="doc">Returns the specified header.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L226">Source</a></div></div><div class="public" id="var-lookup-param"><h3>lookup-param</h3><h4 class="macro">macro</h4><div class="usage"><code>(lookup-param param)</code></div><pre class="doc">Returns the specified param.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L212">Source</a></div></div><div class="public" id="var-map-%3ERouter"><h3>map-&gt;Router</h3><div class="usage"><code>(map-&gt;Router m3917)</code></div><pre class="doc">Factory function for class Router, taking a map of keywords to field values, but not 400x slower than -&gt;x like the clojure.core version
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L240">Source</a></div></div><div class="public" id="var-method"><h3>method</h3><h4 class="macro">macro</h4><div class="usage"><code>(method method &amp; body)</code></div><pre class="doc">If the request-method key matches meth,
 evaluate body.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L105">Source</a></div></div><div class="public" id="var-not-traversed"><h3>not-traversed</h3><h4 class="macro">macro</h4><div class="usage"><code>(not-traversed &amp; body)</code></div><pre class="doc">If the current path level has not been traversed
previously, evaluate body.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L132">Source</a></div></div><div class="public" id="var-param"><h3>param</h3><h4 class="macro">macro</h4><div class="usage"><code>(param parser bindings &amp; body)</code></div><pre class="doc">If the next path segment can be matched according
to regex pattern, use the corresponding parser and
evaluate body with bindings set to parsed value.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L113">Source</a></div></div><div class="public" id="var-params"><h3>params</h3><h4 class="macro">macro</h4><div class="usage"><code>(params)</code></div><pre class="doc">Returns the params map (if present).

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L205">Source</a></div></div><div class="public" id="var-path"><h3>path</h3><h4 class="macro">macro</h4><div class="usage"><code>(path segment &amp; body)</code></div><pre class="doc">If the next path segment matches segment,
evaluate body.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L97">Source</a></div></div><div class="public" id="var-pred"><h3>pred</h3><h4 class="macro">macro</h4><div class="usage"><code>(pred p bindings &amp; body)</code></div><pre class="doc">If (p path-segment) returns truthy then,
evaluate body with bindings set to the value
returned by (p path-segment).

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L81">Source</a></div></div><div class="public" id="var-request"><h3>request</h3><h4 class="macro">macro</h4><div class="usage"><code>(request)</code></div><pre class="doc">Returns the request map.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L191">Source</a></div></div><div class="public" id="var-route"><h3>route</h3><h4 class="macro">macro</h4><div class="usage"><code>(route &amp; body)</code></div><pre class="doc"></pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L363">Source</a></div></div><div class="public" id="var-route%27"><h3>route'</h3><h4 class="macro">macro</h4><div class="usage"><code>(route' &amp; body)</code></div><pre class="doc"></pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L376">Source</a></div></div><div class="public" id="var-routes"><h3>routes</h3><div class="usage"><code>(routes &amp; handlers)</code></div><pre class="doc">Inputs: [&amp; handlers :- [(Fn Any [Request])]]
Returns: (Fn Any [Request])

Compose multiple routes. Calls respond.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L390">Source</a></div></div><div class="public" id="var-scheme"><h3>scheme</h3><h4 class="macro">macro</h4><div class="usage"><code>(scheme s &amp; body)</code></div><pre class="doc">If the scheme key matches s, evaluate body.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L67">Source</a></div></div><div class="public" id="var-static"><h3>static</h3><h4 class="macro">macro</h4><div class="usage"><code>(static segments opts)</code></div><pre class="doc">If the next path segment matches a value in the
segments set and the request method is get,
return a file response corresponding to the
requested file.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L122">Source</a></div></div><div class="public" id="var-strict-map-%3ERouter"><h3>strict-map-&gt;Router</h3><div class="usage"><code>(strict-map-&gt;Router m3918 &amp; [drop-extra-keys?__1737__auto__])</code></div><pre class="doc">Factory function for class Router, taking a map of keywords to field values.  All keys are required, and no extra keys are allowed.  Even faster than map-&gt;
</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L240">Source</a></div></div><div class="public" id="var-terminate"><h3>terminate</h3><h4 class="macro">macro</h4><div class="usage"><code>(terminate resp)</code></div><pre class="doc">Terminate and respond with resp immediately.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L150">Source</a></div></div><div class="public" id="var-truncate"><h3>truncate</h3><h4 class="macro">macro</h4><div class="usage"><code>(truncate &amp; body)</code></div><pre class="doc">Truncate any remaining path segments and evaluate body.
If a response is not created inside truncate
(for example, by means of a call to method),
revert the zipper to it's previous state.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L140">Source</a></div></div><div class="public" id="var-url"><h3>url</h3><h4 class="macro">macro</h4><div class="usage"><code>(url)</code></div><pre class="doc">Returns the request url.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L198">Source</a></div></div><div class="public" id="var-zipper"><h3>zipper</h3><h4 class="macro">macro</h4><div class="usage"><code>(zipper)</code></div><pre class="doc">Inspect the current state of the zipper. Useful
for debugging.

Use with route or route'.</pre><div class="src-link"><a href="https://github.com/stch-library/routing/blob/master/src/stch/routing.clj#L167">Source</a></div></div></div></body></html>